import{r as c,j as e,S as k,J as w}from"./app-DqvPgPLX.js";import{X as C,A as y,a as S,b as D,M as h,C as L}from"./CitizenLayout-CZTR47zY.js";import{B as m,I as _}from"./input-_-d2rHVp.js";import{C as A}from"./card-f358nuNf.js";import{S as G}from"./search-BSytNz48.js";import{U as u}from"./users-C4kToFlf.js";import"./index-28FC01iy.js";import"./Combination-bzKAMG6s.js";import"./createLucideIcon-9_-YZXNr.js";const M=({chatGroups:t})=>{const[n,f]=c.useState(""),[d,i]=c.useState(!1),[r,g]=c.useState(!1);c.useEffect(()=>{const s=()=>{const a=window.innerWidth<768;g(a),i(!a)};return s(),window.addEventListener("resize",s),()=>window.removeEventListener("resize",s)},[]);const l=t.filter(s=>s.mission.title.toLowerCase().includes(n.toLowerCase())),p=s=>{const a=new Date(s),x=(new Date().getTime()-a.getTime())/(1e3*60*60);return x<24?a.toLocaleTimeString("id-ID",{hour:"2-digit",minute:"2-digit"}):x<168?a.toLocaleDateString("id-ID",{weekday:"short",hour:"2-digit",minute:"2-digit"}):a.toLocaleDateString("id-ID",{day:"numeric",month:"short",hour:"2-digit",minute:"2-digit"})},j=s=>s.split(" ").map(a=>a[0]).join("").toUpperCase().slice(0,2),b=s=>s.chats&&s.chats.length>0?s.chats[0]:null,N=s=>{r&&i(!1),k.visit(`/chatgroup/${s.id}`)},o=()=>{i(!d)},v=()=>{r&&d&&i(!1)};return e.jsxs("div",{className:"relative flex h-screen bg-background",children:[r&&d&&e.jsx("div",{className:"fixed inset-0 z-40 bg-black/50 backdrop-blur-sm md:hidden",onClick:v}),e.jsx("div",{className:` ${d?"translate-x-0":"-translate-x-full"} ${r?"fixed left-0 top-0 z-50 h-full":"relative"} w-80 max-w-[85vw] overflow-hidden border-r bg-card transition-transform duration-300 ease-in-out md:static md:max-w-none md:translate-x-0`,children:e.jsxs("div",{className:"flex flex-col h-full",children:[e.jsxs("div",{className:"flex-shrink-0 p-4 border-b",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-lg font-semibold",children:"Grup Chat"}),e.jsx(m,{variant:"ghost",size:"sm",className:"md:hidden",onClick:()=>i(!1),children:e.jsx(C,{className:"w-4 h-4"})})]}),e.jsx("p",{className:"mb-4 text-sm text-muted-foreground",children:"Daftar grup chat dari misi yang Anda ikuti"}),e.jsxs("div",{className:"relative",children:[e.jsx(G,{className:"absolute w-4 h-4 transform -translate-y-1/2 left-3 top-1/2 text-muted-foreground"}),e.jsx(_,{type:"text",placeholder:"Cari grup chat...",value:n,onChange:s=>f(s.target.value),className:"pl-10"})]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto",children:l.length===0?e.jsx("div",{className:"p-4",children:e.jsxs("div",{className:"py-8 text-center",children:[e.jsx(u,{className:"w-12 h-12 mx-auto mb-4 text-muted-foreground"}),e.jsx("h3",{className:"mb-2 text-lg font-medium text-foreground",children:n?"Tidak ada grup yang ditemukan":"Belum ada grup chat"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:n?"Coba ubah kata kunci pencarian Anda":"Grup chat akan muncul setelah Anda bergabung dengan misi"})]})}):e.jsx("div",{className:"p-2 space-y-1",children:l.map(s=>{const a=b(s);return e.jsx(A,{className:"cursor-pointer p-3 transition-all duration-200 hover:scale-[1.02] hover:bg-accent hover:shadow-md active:scale-[0.98]",onClick:()=>N(s),children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsxs(y,{className:"flex-shrink-0 w-12 h-12",children:[e.jsx(S,{src:s.mission.thumbnail||"",alt:s.mission.title}),e.jsx(D,{className:"text-xs bg-sky-600 text-primary-foreground",children:j(s.mission.title)})]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-start justify-between mb-1",children:[e.jsx("h3",{className:"pr-2 text-sm font-medium truncate text-foreground",children:s.mission.title}),s.unread_messages_count&&s.unread_messages_count>0&&e.jsx("span",{className:"inline-flex min-w-[1.25rem] flex-shrink-0 items-center justify-center rounded-full bg-primary px-2 py-1 text-xs font-bold leading-none text-white",children:s.unread_messages_count>99?"99+":s.unread_messages_count})]}),a&&e.jsxs("div",{className:"space-y-1",children:[e.jsxs("p",{className:"text-xs truncate text-muted-foreground",children:[e.jsx("span",{className:"font-medium",children:"Last Message:"})," ",a.content||"Media"]}),e.jsx("span",{className:"text-xs text-muted-foreground",children:p(a.created_at)})]}),!a&&e.jsx("p",{className:"text-xs text-muted-foreground",children:"Belum ada pesan"})]})]})},s.id)})})}),l.length>0&&e.jsx("div",{className:"flex-shrink-0 px-4 py-2 mt-2 border-t",children:e.jsxs("div",{className:"text-xs text-center text-muted-foreground",children:["Menampilkan ",l.length," dari"," ",t.length," grup chat"]})})]})}),e.jsxs("div",{className:"flex flex-col flex-1 min-w-0",children:[e.jsx("div",{className:"flex items-center justify-between p-4 border-b bg-card",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(m,{variant:"ghost",size:"sm",className:"md:hidden",onClick:o,children:e.jsx(h,{className:"w-4 h-4"})}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("h3",{className:"font-semibold text-foreground",children:"Selamat Datang di Grup Chat"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Pilih grup chat untuk memulai percakapan"})]})]})}),e.jsx("div",{className:"flex items-center justify-center flex-1 p-4 sm:p-8",children:e.jsxs("div",{className:"w-full max-w-md text-center",children:[e.jsx("div",{className:"mb-6",children:e.jsx(u,{className:"w-12 h-12 mx-auto mb-4 text-muted-foreground sm:h-16 sm:w-16"})}),e.jsx("h2",{className:"mb-2 text-xl font-bold text-foreground sm:text-2xl",children:"Pilih Grup Chat"}),e.jsx("p",{className:"mb-6 text-sm text-muted-foreground sm:text-base",children:r?e.jsx(e.Fragment,{children:"Tap tombol menu di atas untuk melihat daftar grup chat dan mulai percakapan."}):e.jsx(e.Fragment,{children:"Pilih grup chat dari sidebar untuk mulai percakapan dengan sesama peserta misi."})}),r&&e.jsxs(m,{onClick:o,className:"w-full mb-6 sm:w-auto",size:"lg",children:[e.jsx(h,{className:"w-4 h-4 mr-2"}),"Lihat Grup Chat"]}),t.length===0?e.jsxs("div",{className:"p-4 rounded-lg bg-accent sm:p-6",children:[e.jsx("h3",{className:"mb-2 font-medium text-foreground",children:"Belum ada grup chat tersedia"}),e.jsx("p",{className:"text-xs text-muted-foreground sm:text-sm",children:"Grup chat akan otomatis terbuat ketika Anda bergabung dengan sebuah misi. Bergabunglah dengan misi untuk mulai berinteraksi dengan peserta lain!"})]}):l.length===0&&n?e.jsxs("div",{className:"p-4 rounded-lg bg-accent sm:p-6",children:[e.jsx("h3",{className:"mb-2 font-medium text-foreground",children:"Tidak ada hasil pencarian"}),e.jsx("p",{className:"text-xs text-muted-foreground sm:text-sm",children:"Coba gunakan kata kunci yang berbeda untuk mencari grup chat."})]}):null]})}),e.jsx("div",{className:"p-3 border-t bg-card sm:p-4",children:e.jsxs("div",{className:"flex justify-center space-x-4 text-xs text-muted-foreground sm:space-x-6 sm:text-sm",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"font-semibold text-foreground",children:t.length}),e.jsx("div",{className:"hidden sm:block",children:"Total Grup"}),e.jsx("div",{className:"sm:hidden",children:"Grup"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"font-semibold text-foreground",children:t.reduce((s,a)=>s+(a.unread_messages_count||0),0)}),e.jsx("div",{className:"hidden sm:block",children:"Pesan Belum Dibaca"}),e.jsx("div",{className:"sm:hidden",children:"Belum Dibaca"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"font-semibold text-foreground",children:t.filter(s=>s.chats&&s.chats.length>0).length}),e.jsx("div",{className:"hidden sm:block",children:"Grup Aktif"}),e.jsx("div",{className:"sm:hidden",children:"Aktif"})]})]})})]})]})},H=()=>{const{props:t}=w(),{chatGroups:n}=t;return console.log("chatGroups",n),e.jsx(L,{currentPage:"chat",children:e.jsx(M,{chatGroups:n})})};export{H as default};
