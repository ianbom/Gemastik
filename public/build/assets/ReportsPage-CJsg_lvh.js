import{r as x,j as e,S as D,J as M}from"./app-D1PQqydB.js";import{B as o,C as E}from"./CitizenLayout-D6PfXXw3.js";import{B as j,I as H}from"./input-BOaatTCr.js";import{C,b as K,c as I,a as F}from"./card-DS9sCv-E.js";import{S as v,a as f,b,c as N,d as r}from"./select-Bh72tW7-.js";import{g as U,T as W}from"./categoryReportLabel-C6qXczy-.js";import{a as $}from"./formatDate-DdkzSpcV.js";import{g as J,a as Q}from"./reportStatusLabel-CeJ63OXr.js";import{P as G}from"./plus-DIhToIk3.js";import{S as O}from"./sliders-horizontal-CIx4Y1C6.js";import{R as Z}from"./refresh-ccw-DVaoXrPH.js";import{S as q}from"./search-DduYLnXE.js";import{M as X}from"./map-pin-D80-uoOx.js";import{C as Y}from"./calendar-B_2puXlR.js";import{T as ee}from"./thumbs-down-D3eec7d2.js";import{E as ae}from"./eye-V8MiIAM9.js";import"./index-Clxr7tAl.js";import"./Combination-Dr_exLUy.js";import"./createLucideIcon--13BBMxb.js";import"./index-DwRUccRl.js";const se=({reports:d,provinces:u,myReports:h,onViewDetails:p,onCreateReport:y})=>{const[c,g]=x.useState("newest"),[i,w]=x.useState(""),[k,A]=x.useState(d),[s,S]=x.useState({category:"semua",status:"semua",province:"semua",startDate:"",endDate:""}),n=(a,t)=>{S(l=>({...l,[a]:t}))},L=()=>{S({category:"semua",status:"semua",province:"semua",startDate:"",endDate:""}),w("")};x.useEffect(()=>{let a=[...d];i.trim()&&(a=a.filter(t=>{var l;return t.title.toLowerCase().includes(i.toLowerCase())||((l=t.description)==null?void 0:l.toLowerCase().includes(i.toLowerCase()))})),s.category!=="semua"&&(a=a.filter(t=>t.category.toLowerCase()===s.category.toLowerCase())),s.status!=="semua"&&(a=a.filter(t=>t.status.toLowerCase()===s.status.toLowerCase())),s.province!=="semua"&&(a=a.filter(t=>{var l;return(l=t.province)==null?void 0:l.name.toLowerCase().includes(s.province.toLowerCase())})),s.startDate&&(a=a.filter(t=>{const l=new Date(t.created_at),m=new Date(s.startDate);return l>=m})),s.endDate&&(a=a.filter(t=>{const l=new Date(t.created_at),m=new Date(s.endDate);return m.setHours(23,59,59,999),l<=m})),c==="newest"?a.sort((t,l)=>new Date(l.created_at).getTime()-new Date(t.created_at).getTime()):c==="oldest"?a.sort((t,l)=>new Date(t.created_at).getTime()-new Date(l.created_at).getTime()):c==="popular"?a.sort((t,l)=>(l.upvotes_count||0)-(t.upvotes_count||0)):c==="status"?a.sort((t,l)=>t.status.localeCompare(l.status)):c==="title"&&a.sort((t,l)=>t.title.localeCompare(l.title)),A(a)},[d,i,c,s]);const V=[{label:"Sampah Plastik",value:"sampah-plastik"},{label:"Pencemaran Air",value:"pencemaran-air"},{label:"Pencemaran Udara",value:"pencemaran-udara"},{label:"Pencemaran Tanah",value:"pencemaran-tanah"},{label:"Limbah Industri",value:"limbah-industri"},{label:"Emisi Gas Rumah Kaca",value:"emisi-gas-rumah-kaca"},{label:"Penggundulan / Kebakaran Hutan",value:"penggundulan-kebakaran-hutan"},{label:"Naiknya Permukaan Air Laut",value:"naiknya-permukaan-air-laut"},{label:"Limbah Pertanian / Peternakan",value:"limbah-pertanian-peternakan"},{label:"Lainnya",value:"lainnya"}],P=i.trim()||s.category!=="semua"||s.status!=="semua"||s.province!=="semua"||s.startDate||s.endDate;return e.jsxs("div",{className:"mx-auto max-w-7xl px-4 py-8 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"mb-8 flex flex-col items-start justify-between md:flex-row md:items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"mb-2 text-3xl font-bold text-gray-900",children:h?"Laporan Saya":"Daftar Laporan"}),e.jsx("p",{className:"text-gray-600",children:h?"Laporan yang dibuat oleh Anda":"Temukan Laporan dan bergabung dalam aksi penyelamatan lingkungan"})]}),e.jsxs(j,{onClick:y,className:"mt-4 bg-emerald-700 text-white hover:bg-emerald-800 md:mt-0",size:"lg",children:[e.jsx(G,{size:20,className:"mr-2"}),"Buat Laporan Baru"]})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-8 lg:grid-cols-4",children:[e.jsx("div",{className:"lg:col-span-1",children:e.jsxs(C,{className:"sticky top-24 overflow-visible",children:[e.jsx(K,{children:e.jsxs(I,{className:"flex items-center justify-between text-lg",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(O,{size:20,className:"mr-2 text-emerald-600"}),"Filter Laporan"]}),P&&e.jsx("span",{className:"rounded-full bg-emerald-100 px-2 py-1 text-xs text-emerald-600",children:"Aktif"})]})}),e.jsxs(F,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Kategori"}),e.jsxs(v,{value:s.category,onValueChange:a=>n("category",a),children:[e.jsx(f,{children:e.jsx(b,{placeholder:"Pilih kategori"})}),e.jsxs(N,{children:[e.jsx(r,{value:"semua",children:"Semua Kategori"}),V.map(a=>e.jsx(r,{value:a.value,children:a.label},a.value))]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Status"}),e.jsxs(v,{value:s.status,onValueChange:a=>n("status",a),children:[e.jsx(f,{children:e.jsx(b,{placeholder:"Pilih status"})}),e.jsxs(N,{children:[e.jsx(r,{value:"semua",children:"Semua Status"}),e.jsx(r,{value:"pending",children:"Menunggu"}),e.jsx(r,{value:"verified",children:"Terverifikasi"}),e.jsx(r,{value:"on-progress",children:"Sedang Diproses"}),e.jsx(r,{value:"rejected",children:"Ditolak"}),e.jsx(r,{value:"completed",children:"Selesai"}),e.jsx(r,{value:"under-authority",children:"Ditangani Pihak Berwenang"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Provinsi"}),e.jsxs(v,{value:s.province,onValueChange:a=>n("province",a),children:[e.jsx(f,{children:e.jsx(b,{placeholder:"Pilih provinsi"})}),e.jsxs(N,{children:[e.jsx(r,{value:"semua",children:"Semua Provinsi"}),u==null?void 0:u.map(a=>e.jsx(r,{value:a.name,children:a.name},a.id))]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Tanggal Mulai"}),e.jsx("input",{type:"date",className:"w-full rounded-md border border-gray-200 px-2 py-2",value:s.startDate,onChange:a=>n("startDate",a.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Tanggal Selesai"}),e.jsx("input",{type:"date",className:"w-full rounded-md border border-gray-200 px-2 py-2",value:s.endDate,onChange:a=>n("endDate",a.target.value),min:s.startDate})]}),e.jsx("div",{className:"space-y-2 pt-4",children:e.jsxs(j,{variant:"outline",className:"flex w-full items-center justify-center gap-2",onClick:L,disabled:!P,children:[e.jsx(Z,{className:"h-4 w-4"}),"Reset Filter"]})})]})]})}),e.jsxs("div",{className:"lg:col-span-3",children:[e.jsxs("div",{className:"mb-6 flex flex-col items-start justify-between gap-4 sm:flex-row sm:items-center",children:[e.jsx("div",{className:"flex items-center space-x-4",children:e.jsxs(v,{value:c,onValueChange:g,children:[e.jsx(f,{className:"w-48",children:e.jsx(b,{placeholder:"Urutkan berdasarkan"})}),e.jsxs(N,{children:[e.jsx(r,{value:"newest",children:"Terbaru"}),e.jsx(r,{value:"oldest",children:"Terlama"}),e.jsx(r,{value:"popular",children:"Terpopuler"}),e.jsx(r,{value:"status",children:"Status"}),e.jsx(r,{value:"title",children:"Judul A-Z"})]})]})}),e.jsxs("div",{className:"relative w-full sm:w-64",children:[e.jsx(q,{className:"absolute left-3 top-3 h-4 w-4 text-gray-400"}),e.jsx(H,{placeholder:"Cari laporan...",className:"pl-10",value:i,onChange:a=>w(a.target.value)})]})]}),(s.category!=="semua"||s.status!=="semua"||s.province!=="semua"||s.startDate||s.endDate||i)&&e.jsxs("div",{className:"mb-4 flex flex-wrap gap-2",children:[e.jsx("span",{className:"mr-2 text-sm font-medium text-gray-700",children:"Filter aktif:"}),i&&e.jsxs(o,{variant:"secondary",className:"flex items-center gap-1",children:['Pencarian: "',i,'"',e.jsx("button",{onClick:()=>w(""),className:"ml-1 text-xs",children:"×"})]}),s.category!=="semua"&&e.jsxs(o,{variant:"secondary",className:"flex items-center gap-1",children:["Kategori: ",s.category,e.jsx("button",{onClick:()=>n("category","semua"),className:"ml-1 text-xs",children:"×"})]}),s.status!=="semua"&&e.jsxs(o,{variant:"secondary",className:"flex items-center gap-1",children:["Status: ",s.status,e.jsx("button",{onClick:()=>n("status","semua"),className:"ml-1 text-xs",children:"×"})]}),s.province!=="semua"&&e.jsxs(o,{variant:"secondary",className:"flex items-center gap-1",children:["Provinsi: ",s.province,e.jsx("button",{onClick:()=>n("province","semua"),className:"ml-1 text-xs",children:"×"})]}),(s.startDate||s.endDate)&&e.jsxs(o,{variant:"secondary",className:"flex items-center gap-1",children:["Tanggal: ",s.startDate||"..."," -"," ",s.endDate||"...",e.jsx("button",{onClick:()=>{n("startDate",""),n("endDate","")},className:"ml-1 text-xs",children:"×"})]})]}),k.length>0?e.jsx(e.Fragment,{children:e.jsx("div",{className:"grid grid-cols-1 gap-6 md:grid-cols-2 xl:grid-cols-3",children:k.map(a=>{var t,l,m,T,_,B,z,R;return e.jsxs(C,{className:"group cursor-pointer border-0 shadow-md transition-all duration-300 hover:-translate-y-1 hover:shadow-lg",onClick:()=>p(a.id),children:[e.jsxs("div",{className:"relative overflow-hidden rounded-t-lg",children:[(m=(l=(t=a.media)==null?void 0:t[0])==null?void 0:l.media_type)!=null&&m.startsWith("video")?e.jsxs("div",{className:"relative h-48 w-full bg-black",children:[e.jsx("video",{className:"h-full w-full object-cover opacity-50",src:`/storage/${a.media[0].media_url}`,muted:!0,preload:"metadata"}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsx("div",{className:"rounded-full bg-white/80 p-2",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 text-black",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M14.752 11.168l-5.197-3.03A1 1 0 008 9.03v5.94a1 1 0 001.555.832l5.197-3.03a1 1 0 000-1.664z"})})})})]}):e.jsx("img",{src:`/storage/${(_=(T=a.media)==null?void 0:T[0])==null?void 0:_.media_url}`,alt:a.title,className:"h-48 w-full object-cover transition-transform duration-300 group-hover:scale-105"}),e.jsx("div",{className:"absolute right-3 top-3",children:e.jsx(o,{className:Q(a.status),children:J(a.status)})}),a.mission&&e.jsx("div",{className:"absolute left-3 top-3",children:e.jsx(o,{className:"bg-indigo-100 text-indigo-700",children:"Ada Misi"})})]}),e.jsxs(F,{className:"p-4",children:[e.jsx("div",{className:"mb-2",children:e.jsx(o,{variant:"outline",className:"mb-2 text-xs",children:U(a.category)})}),e.jsx("h3",{className:"mb-2 line-clamp-2 font-semibold text-gray-900 transition-colors group-hover:text-emerald-600",children:a.title}),e.jsxs("div",{className:"mb-3 flex items-center text-sm text-gray-500",children:[e.jsx(X,{size:14,className:"mr-1"}),e.jsxs("span",{className:"truncate",children:[(B=a.district)==null?void 0:B.name,","," ",(z=a.city)==null?void 0:z.name,","," ",(R=a.province)==null?void 0:R.name]})]}),e.jsxs("div",{className:"mb-4 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center text-sm text-gray-500",children:[e.jsx(Y,{size:14,className:"mr-1"}),e.jsx("span",{children:$(a.created_at)})]}),e.jsxs("div",{className:"flex items-center justify-between gap-5",children:[e.jsxs("div",{className:"flex items-center text-sm font-medium text-emerald-600",children:[e.jsx(W,{size:14,className:"mr-1"}),e.jsx("span",{children:a.upvotes_count||0})]}),e.jsxs("div",{className:"flex items-center text-sm font-medium text-red-600",children:[e.jsx(ee,{size:14,className:"mr-1"}),e.jsx("span",{children:a.dislikes_count||0})]})]})]}),e.jsxs(j,{className:"mt-auto w-full bg-amber-500 transition-colors duration-200 hover:bg-amber-700",onClick:()=>{D.visit(`/report/${a.id}`)},children:[e.jsx(ae,{size:16,className:"mr-2"}),"Lihat Detail"]})]})]},a.id)})})}):e.jsx("div",{className:"flex w-full items-center justify-center",children:e.jsxs(C,{className:"w-full px-8 py-32 text-center",children:[e.jsx("div",{className:"mb-4 flex justify-center",children:e.jsx("div",{className:"rounded-full bg-gray-100 p-4",children:e.jsx("svg",{className:"h-12 w-12 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})})}),e.jsx("h3",{className:"mb-2 text-lg font-semibold text-gray-900",children:i||s.category!=="semua"||s.status!=="semua"||s.province!=="semua"||s.startDate||s.endDate?"Tidak Ada Laporan yang Sesuai Filter":"Laporan Belum Tersedia"}),e.jsx("p",{className:"text-sm text-gray-500",children:i||s.category!=="semua"||s.status!=="semua"||s.province!=="semua"||s.startDate||s.endDate?"Coba ubah atau hapus beberapa filter untuk melihat lebih banyak laporan.":"Belum ada laporan yang tersedia saat ini. Coba buat laporan baru."}),(i||s.category!=="semua"||s.status!=="semua"||s.province!=="semua"||s.startDate||s.endDate)&&e.jsx(j,{variant:"outline",className:"mt-4",onClick:L,children:"Reset Semua Filter"})]})})]})]})]})},we=({myReports:d})=>{var g;const{props:u}=M(),h=((g=u.reports)==null?void 0:g.data)||[],p=u.provinces.provinces,y=i=>{D.visit(route("report.show",{id:i}))},c=()=>{D.visit(route("create.report"))};return console.log("provinsi",p),e.jsx(E,{currentPage:d?"my-report":"report",children:e.jsx(se,{myReports:d,reports:h,provinces:p,onViewDetails:y,onCreateReport:c})})};export{we as default};
